<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ â€” Firebase Auth</title>
  <style>
    :root{--bg:#0f172a;--card:#111827;--muted:#94a3b8;--brand:#22c55e;--danger:#ef4444}
    *{box-sizing:border-box}
    body{margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, Tajawal, Arial; background:var(--bg); color:#e5e7eb}
    .wrap{min-height:100dvh; display:grid; place-items:center; padding:24px}
    .card{width:100%; max-width:440px; background:var(--card); border:1px solid #1f2937; border-radius:16px; padding:22px; box-shadow:0 10px 40px rgba(0,0,0,.25)}
    h1{margin:0 0 8px; font-size:24px}
    p{margin:0 0 16px; color:var(--muted)}
    label{display:block; margin:10px 0 6px}
    input[type="email"], input[type="password"], input[type="text"]{width:100%; padding:12px 14px; border-radius:12px; border:1px solid #334155; background:#0b1220; color:#e5e7eb}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .actions{display:flex; align-items:center; justify-content:space-between; margin-top:14px}
    .btn{padding:10px 14px; border-radius:12px; border:1px solid #16a34a; background:var(--brand); color:#0b1220; cursor:pointer; font-weight:600}
    .btn.secondary{border-color:#334155; background:#0b1220; color:#e5e7eb}
    .btn.google{border-color:#eab308; background:#fde68a; color:#111827}
    .btn:hover{filter:brightness(.96)}
    .muted{color:var(--muted)}
    .err{margin-top:10px; color:var(--danger); font-size:14px; min-height:20px; white-space:pre-wrap}
    .ok{color:#22c55e}
    .footer{margin-top:16px; font-size:12px; color:#9ca3af; text-align:center}
    .divider{height:1px; background:#1f2937; margin:16px 0}
    .hidden{display:none}
    .userbox{background:#0b1220; border:1px solid #334155; border-radius:12px; padding:12px; margin-top:12px}
    a{color:#93c5fd}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
      <p class="muted">Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ ÙŠØ±Ø¨Ø· Ø§Ù„ØµÙØ­Ø© Ø¨Ù€ Firebase Authentication.</p>

      <!-- Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
      <div id="userBox" class="userbox hidden"></div>

      <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¨Ø±ÙŠØ¯/ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
      <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
      <input id="email" type="email" placeholder="you@example.com" />

      <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
      <div class="row">
        <input id="password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
        <button id="togglePwd" class="btn secondary" type="button">Ø¥Ø¸Ù‡Ø§Ø±</button>
      </div>

      <div class="actions">
        <button id="btnLogin" class="btn" type="button">Ø¯Ø®ÙˆÙ„</button>
        <button id="btnSignup" class="btn secondary" type="button">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
      </div>

      <div class="row" style="margin-top:10px">
        <button id="btnGoogle" class="btn google" type="button">Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Google</button>
        <button id="btnAnon" class="btn secondary" type="button">Ø¯Ø®ÙˆÙ„ Ù…Ø¬Ù‡ÙˆÙ„</button>
      </div>

      <div class="row" style="margin-top:10px">
        <button id="btnReset" class="btn secondary" type="button">Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
        <button id="btnLogout" class="btn secondary" type="button">Ø®Ø±ÙˆØ¬</button>
      </div>

      <div id="msg" class="err"></div>
      <div class="divider"></div>
      <div class="footer">ğŸ’¡ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…: ÙØ¹ÙÙ‘Ù„ Ù…Ø²ÙˆØ¯ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ù† Firebase Console â†’ Authentication â†’ Sign-in method. ÙˆØ£Ø¶Ù Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØµØ±Ù‘Ø­ Ø¨Ù‡Ø§.</div>
    </div>
  </div>

  <!-- Firebase SDK (ES Modules) -->
  <script type="module">
    // 1) Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ­Ø¯Ø§Øª Firebase Auth
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { 
      getAuth, 
      onAuthStateChanged, 
      signInWithEmailAndPassword, 
      createUserWithEmailAndPassword, 
      sendPasswordResetEmail,
      signInAnonymously,
      signOut,
      GoogleAuthProvider,
      signInWithPopup
    } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

    // 2) Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ â€” Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ù‚ÙŠÙ… Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù…Ù† Firebase Console
    const firebaseConfig = {
      apiKey: "PASTE_YOUR_API_KEY",
      authDomain: "PASTE_YOUR_PROJECT.firebaseapp.com",
      projectId: "PASTE_YOUR_PROJECT",
      storageBucket: "PASTE_YOUR_PROJECT.firebasestorage.app",
      messagingSenderId: "",
      appId: "",
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    const $ = (s)=>document.querySelector(s);
    const emailEl = $("#email");
    const passEl = $("#password");
    const msgEl = $("#msg");
    const userBox = $("#userBox");

    // Ø¹Ø±Ø¶/Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    $("#togglePwd").addEventListener("click", ()=>{
      const isPwd = passEl.getAttribute("type") === "password";
      passEl.setAttribute("type", isPwd ? "text" : "password");
      $("#togglePwd").textContent = isPwd ? "Ø¥Ø®ÙØ§Ø¡" : "Ø¥Ø¸Ù‡Ø§Ø±";
    });

    // Ù…Ø¨Ø¯Ù„ Ø±Ø³Ø§Ø¦Ù„
    const showMsg = (text, ok=false)=>{
      msgEl.textContent = text || "";
      msgEl.className = ok ? "ok" : "err";
    };

    // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    onAuthStateChanged(auth, (user)=>{
      if(user){
        const name = user.displayName || "â€”";
        const email = user.email || "â€”";
        userBox.innerHTML = `âœ… Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„:<br>UID: <b>${user.uid}</b><br>Ø§Ù„Ø§Ø³Ù…: <b>${name}</b><br>Ø§Ù„Ø¨Ø±ÙŠØ¯: <b>${email}</b>`;
        userBox.classList.remove("hidden");
      } else {
        userBox.classList.add("hidden");
      }
    });

    // Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯/ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    $("#btnLogin").addEventListener("click", async()=>{
      try{
        showMsg("");
        await signInWithEmailAndPassword(auth, emailEl.value, passEl.value);
        showMsg("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­", true);
      }catch(e){ showMsg(mapAuthError(e)); }
    });

    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
    $("#btnSignup").addEventListener("click", async()=>{
      try{
        showMsg("");
        await createUserWithEmailAndPassword(auth, emailEl.value, passEl.value);
        showMsg("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", true);
      }catch(e){ showMsg(mapAuthError(e)); }
    });

    // Ø¯Ø®ÙˆÙ„ Ù…Ø¬Ù‡ÙˆÙ„
    $("#btnAnon").addEventListener("click", async()=>{
      try{ showMsg(""); await signInAnonymously(auth); showMsg("ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¬Ù‡ÙˆÙ„", true); }
      catch(e){ showMsg(mapAuthError(e)); }
    });

    // Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Google (Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø©)
    $("#btnGoogle").addEventListener("click", async()=>{
      try{ showMsg(""); await signInWithPopup(auth, provider); showMsg("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Google", true); }
      catch(e){ showMsg(mapAuthError(e)); }
    });

    // Ø±Ø§Ø¨Ø· Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    $("#btnReset").addEventListener("click", async()=>{
      try{ 
        await sendPasswordResetEmail(auth, emailEl.value);
        showMsg("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ", true);
      }catch(e){ showMsg(mapAuthError(e)); }
    });

    // Ø®Ø±ÙˆØ¬
    $("#btnLogout").addEventListener("click", async()=>{
      try{ await signOut(auth); showMsg("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬", true); }
      catch(e){ showMsg(mapAuthError(e)); }
    });

    // Ù…Ø³Ø§Ø¹Ø¯ Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…ÙÙ‡ÙˆÙ…Ø©
    function mapAuthError(e){
      const code = e?.code || "unknown";
      const table = {
        "auth/invalid-email": "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­",
        "auth/missing-password": "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
        "auth/weak-password": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ© (Ø¬Ø±Ù‘Ø¨ 6 Ø£Ø­Ø±Ù ÙØ£ÙƒØ«Ø±)",
        "auth/email-already-in-use": "Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ù‹Ø§",
        "auth/invalid-credential": "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©",
        "auth/popup-closed-by-user": "ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Google Ù‚Ø¨Ù„ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©",
        "auth/operation-not-allowed": "Ø§Ù„Ù…Ø²ÙˆÙ‘Ø¯ ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„ â€” ÙØ¹Ù‘ÙÙ„Ù‡ Ù…Ù† Console",
      };
      return table[code] || `Ø­Ø¯Ø« Ø®Ø·Ø£: ${code}`;
    }

    // ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©:
    // Ø¥Ø°Ø§ ÙØªØ­Øª Ø§Ù„Ù…Ù„Ù Ø¹Ø¨Ø± file:// Ù‚Ø¯ ØªÙˆØ§Ø¬Ù‡ Ù‚ÙŠÙˆØ¯ Ù…ØªØµÙØ­. Ø§Ø³ØªØ¹Ù…Ù„ Ø®Ø§Ø¯Ù… Ù…Ø­Ù„ÙŠ (Live Server ÙÙŠ VS Code)
    // Ø£Ùˆ Ø§Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ù„Ø£ÙŠ Ø§Ø³ØªØ¶Ø§ÙØ© Ø«Ø§Ø¨ØªØ© (GitHub Pages / Firebase Hosting Ø¨Ø§Ù„Ø±ÙØ¹ Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­).
  </script>
<script type="module">
  // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Firebase
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

  // Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù…Ù† Firebase Console â†’ Project Settings â†’ Web app
  const firebaseConfig = {
    apiKey: "AIzaSyB7e3gjIFkqFzRhUYbsILBnZrapWia6zUs",
    authDomain: "learn-a9948.firebaseapp.com",
    projectId: "learn-a9948",
    storageBucket: "learn-a9948.firebasestorage.app",
    messagingSenderId: "410008299402",
    appId: "1:410008299402:web:2ea3c300b1c38ea6cc8a73"
  };

  // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // Ù…Ø«Ø§Ù„: Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
  document.getElementById("signupBtn").addEventListener("click", async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
      await createUserWithEmailAndPassword(auth, email, password);
      alert("âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­");
    } catch (e) {
      alert("âŒ Ø®Ø·Ø£: " + e.message);
    }
  });

  // Ù…Ø«Ø§Ù„: ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  document.getElementById("loginBtn").addEventListener("click", async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
      const user = await signInWithEmailAndPassword(auth, email, password);
      alert("Ù…Ø±Ø­Ø¨Ø§Ù‹ " + user.user.email);
    } catch (e) {
      alert("âŒ Ø®Ø·Ø£: " + e.message);
    }
  });

  // Ù…Ø«Ø§Ù„: ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
  document.getElementById("logoutBtn").addEventListener("click", async () => {
    await signOut(auth);
    alert("ğŸ‘‹ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
  });
</script>
</body>
</html>
